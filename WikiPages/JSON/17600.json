{
  "PageID": 17600,
  "PageGuid": "ce2cd183-a546-42dc-b5fa-32f763cc79b3",
  "Title": "Notwendige Tätigkeiten für automatische E-Mail-Archivierung mit Microsoft 365",
  "Content": "Notwendige Tätigkeiten für automatische E-Mail-Archivierung mit Microsoft 365\r\n\r\nSystemanforderungen an Firewall\r\nfolgende Ziel-Verbindungen werden von unserem Modul GWC M365 angesprochen und müssen vom Server aus erreichbar sein:\r\n·graph.microsoft.com \r\n·login.microsoftonline.com\r\n\r\n\r\nDie Einrichtung der automatischen E-Mail-Archivierung für Microsoft 365 Konten muss ab dem 01.10.2022 neu eingestellt werden. Dazu ist eine bestimmte Abfolge von Schritten erforderlich:\r\n\r\n1) Registrieren des topfact6 GWC M365 Moduls in Ihrem M365 Account (Verantwortung: Kunde)\r\n\r\nEine Schritt-für-Schritt Anweisungen dazu finden Sie unten!\r\nAls Ergebnis dieser Registrierung benötigt die topfact AG von Ihnen folgende Werte \r\n\r\n·Tenant / Domain \r\n·ClientId / Anwendungs-ID\r\n·Client Secret (Clientschlüssel-Wert)\r\nBitte übermitteln Sie diese Werte über einen sicheren Kanal wie z.B. topfact TIC.\r\n\r\n2) Update von topfact6 auf die Version 2022.10. \r\nWird von der topfact AG durchgeführt\r\n\r\n3) Einrichten der automatischen E-Mail-Archivierung\r\nWird von der topfact AG durchgeführt\r\n\r\n\r\nSchritt für Schritt Anweisung um die App anzulegen und die Schlüssel zu generieren\r\nInfos von Microsoft: https://docs.microsoft.com/de-de/exchange/client-developer/exchange-web-services/how-to-authenticate-an-ews-application-by-using-oauth\r\n\r\nSchritt 1: Domäne auslesen\r\nKlicken Sie im Menü auf (1) \"Azure Active Directory\" dann auf (2) \"Übersicht\" \r\nKopieren Sie den Wert der \"Primären Domäne\"\r\n\r\n\r\nSchritt 2: App registrieren\r\nöffnen Sie das Azure Portal\r\nNavigieren Sie zu (1) \"Azure Active Directory\" > (2) \"App Registrierungen\" > (3) \"Neue Registrierung\"\r\n\r\n\r\n\r\nVergeben Sie den Namen \"topfact GWC\"\r\nWählen Sie die Radiobox \"einzelner Mandant\"\r\n\r\n\r\nWechseln Sie in die gerade erstellte App\r\nBei \"Übersicht\" können Sie die (1) \"Anwendungs-ID (Client)\" kopieren.\r\nWechseln Sie im Menü auf (2) \"Zertifikate und Geheimnisse\"\r\n\r\n\r\nSchritt 3: Schlüssel für die App erzeugen\r\nWechseln Sie auf den Reiter (1) \"Geheime Clientschlüssel\"\r\nKlicken Sie auf (2) \"Neuer geheimer Clientschlüssel\"\r\n\r\n\r\nAuf der rechten Seite erscheint ein Formular für den neuen Schlüssel\r\nGeben sie den Namen \"Used for GWC\" an und definieren Sie die Gültigkeit. \r\nSchlüssel können maximal 2 Jahre gültig sein, dann muss ein neuer Schlüssel generiert und bei topfact konfiguriert werden.\r\nWichtig: der Schlüsselwert ist nur ein einziges Mal direkt nach dem anlegen sichtbar. Sie müssen sich den Wert direkt kopieren.\r\n\r\n\r\nSchritt 4: API Berechtigungen vergeben\r\nNavigieren Sie bei (1) \"Azure Active Directory\" zu (2) \"API Berechtigungen\"\r\nSelektieren Sie (3) \"Berechtigungen hinzufügen\" und dort dann die große Kachel (4) \"Microsoft Graph\"\r\n\r\n\r\nSelektiere \"Anwendungsberechtigungen\"\r\n\r\n\r\n\r\nDie App benötigt zwei Rechte. Beide können rechts in der Liste der Rechte gesucht und selektiert werden\r\n·Directory.ReadAll (um alle Ordner auszulesen und den passenden Abholordner zu definieren)\r\n·Mail.ReadWrite (um E-Mails mit einer Kategorie als fertig archiviert\" zu markieren)\r\n\r\n\r\n\r\nDamit ist die Konfiguration abgeschlossen. \r\nBitte teilen Sie uns die kritischen Werte und Schlüssel nur über einen sicheren Kanal wie z.B. das topfact TIC mit.",
  "Url": "https://services.topfact.de/wiki/pages/view?g=ce2cd183-a546-42dc-b5fa-32f763cc79b3"
}