{
  "PageID": 14618,
  "PageGuid": "08309b29-1c8f-48a9-9f9b-729af7abf578",
  "Title": "Software Verteilung mit Batch-Datei über GPO",
  "Content": "topfact AG\r\nInstallation tf6-Anwendungen mit Log Datei via GPO\r\n \r\n \r\n \r\n \r\n \r\n \r\n \r\n\r\n \r\n \r\n \r\n \r\n\r\n \r\nÜbersicht\r\nÜbersicht \r\nErstellen Einer Batch-Datei \r\nDie IF-Abfrage\r\nInstallationbefehlszeile\r\nPfad für Log-Datei \r\nRegistry-Eintrag schreiben\r\nDie .reg Datei \r\nBatch-Datei in GPO einbinden\r\nNeues Gruppenrichtlinienobjekt erstellen\r\nBatch einbinden\r\nGPO einer Gruppe zuweisen\r\nGP aktualisieren\r\n \r\n \r\n\r\n \r\nErstellen Einer Batch-Datei           \r\n\r\n     \r\n \r\nQuelltext:\r\n \r\necho ##Batchdatei zum Installieren von tf6 Best People##\r\n \r\nIF EXIST \"\\\\PEDC\\topfact AG\\Einarbeitungen\\Herr Paulus\\LOG\\ BP %USERNAME% %COMPUTERNAME%.log\" GOTO BeendeInstalation\r\n \r\nmsiexec /i \"\\\\PEDC\\topfact AG\\Einarbeitungen\\topfact6\\topfact6 Best People.msi\" /quiet /liwearmovp \"\\\\PEDC\\topfact AG\\Einarbeitungen\\Herr Paulus\\LOG\\ BP %USERNAME% %COMPUTERNAME%.log\"\r\nReg import \"\\\\PEDC\\topfact AG\\Einarbeitungen\\topfact6\\topfact6_Best_People_Regkey.reg\"\r\n \r\n:BeendeInstalation\r\n \r\nHierbei ist zu beachten:\r\n\r\n\r\n\r\n\r\nDie IF-Abfrage\r\n\r\n\r\n\r\n\r\n\r\nDie IF-Abfrage ist dazu gedacht, die Batch-Datei nur dann auszuführen wenn noch KEINE Log-Datei vorhanden ist, da diese erst erzeugt wird wenn eine Installation stattgefunden hat. \r\nWill man die Batch erneut ausführen muss man die Log-Datei zuerst löschen. \r\nDie Abfrage kann auch umgestaltet werden sodass z.b. nachgeschaut wird ob die .exe schon vorhanden ist, dies kann je nach belieben erfolgen.\r\n \r\n\r\nInstallationbefehlszeile\r\n\r\n\r\n\r\n\r\n\r\nDiese Zeil führt den Windows-Installer aus. In dem angegebenen Pfad befindet sich das MSI-Paket.\r\n  \r\n\r\nPfad für Log-Datei\r\n\r\n\r\n\r\n\r\n\r\nDieser Pfad legt fest, wohin die Log-Datei gespeichert werden soll. Die Ausdrücke %USERNAME% %COMPUTERNAME% schreiben den Namen des Users und den Computernamen in den Titel der Datei.\r\n \r\n\r\nRegistry-Eintrag schreiben\r\n\r\n\r\n\r\n\r\n\r\nHiermit wird ein Registrierungseintrag gesetzt. Es wird eine .reg Datei aufgerufen:\r\n \r\n \r\nDie .reg Datei\r\n\r\n \r\n\r\nDer Registry-Eintrag ist nötig da sich eine tf6 Anwendung dadurch die Config-Datei beim Erststart selbstständig holen kann.\r\nIn die „SourceDir“ wird der Pfad eingetragen von dem aus das MSI-Paket installiert wird. Dort sollte demnach auch die Config-Datei liegen.\r\n \r\n \r\nBatch-Datei in GPO einbinden\r\n \r\nNeues Gruppenrichtlinienobjekt erstellen\r\n\r\n\r\n \r\n \r\nDieses nun Bearbeiten.\r\n \r\n \r\n \r\nBatch einbinden\r\n \r\nNun Skripts auswählen:\r\n \r\n \r\n \r\n\r\n\r\n\r\n\r\n \r\n\r\nNun den Pfad der Batch-Datei auswählen:\r\n\r\n \r\n\r\n\r\n\r\n\r\nZu Beachten:\r\nEs kann immer nur ein Skipt mit Installationsanweisungen übergeben werden da sonst beide Skripts sich gegenseitig blockieren und nur eines ausgeführt wird. Will man mehr als eine Installation per Skript starten so muss man das in einem Skript machen. Im nachfolgendem Bild wird ein Skript für die Installation für \"Best People\" und \"Facility\" gezeigt.\r\n\r\n\r\nQuelltext:\r\n\r\nECHO ##Batchdatei zum Installieren von Facility und Best People##\r\n\r\nIF EXIST \"\\\\pedc\\topfactAG\\Einarbeitungen\\Herr Paulus\\LOG\\Facility %USERNAME% %COMPUTERNAME%.log\" GOTO NEXT\r\n\r\nMSIEXEC /i \"\\\\pedc\\topfactAG\\Einarbeitungen\\Herr Paulus\\Install tf6 Facility\\topfact6 Facility.msi\" /quiet /liwearmovp \"\\\\pedc\\topfactAG\\Einarbeitungen\\Herr Paulus\\LOG\\Facility %USERNAME% %COMPUTERNAME%.log\"\r\nREG IMPORT \"\\\\pedc\\topfactAG\\Einarbeitungen\\Herr Paulus\\Install tf6 Facility\\topfact6_Facility_Regkey.reg\"\r\n\r\n\r\n:NEXT\r\n\r\nIF EXIST \"\\\\pedc\\topfactAG\\Einarbeitungen\\Herr Paulus\\LOG\\Best People %USERNAME% %COMPUTERNAME%.log\" GOTO BeendeInstalation\r\n\r\nMSIEXEC /i \"\\\\pedc\\topfactAG\\Einarbeitungen\\Herr Paulus\\Install tf6 Best People\\topfact6 Best People.msi\" /quiet /liwearmovp \"\\\\pedc\\topfactAG\\Einarbeitungen\\Herr Paulus\\LOG\\Best People %USERNAME% %COMPUTERNAME%.log\"\r\nREG IMPORT \"\\\\pedc\\topfactAG\\Einarbeitungen\\Herr Paulus\\Install tf6 Best People\\topfact6_Best_People_Regkey.reg\"\r\n\r\n\r\n:BeendeInstalation\r\n\r\n\r\n\r\n\r\nGPO einer Gruppe zuweisen\r\n \r\nDas Gruppenrichtlinienobjekt der jeweiligen Gruppe zuweisen:\r\n \r\n\r\nPer Drag-and-Drop das Gruppenrichtlinienobjekt auf die jeweilige Gruppe ziehen.\r\n \r\nGP aktualisieren\r\n \r\nDie GPO updatet sich alle 90min. automatisch.\r\nMit dem Befehl: gpupdate /force werden die Gruppenrichtlinien sofort aktualisiert. \r\n \r\n\r\nBei dem nächsten Anmelden der User wird nun die Batch-Datei ausgeführt.",
  "Url": "https://services.topfact.de/wiki/pages/view?g=08309b29-1c8f-48a9-9f9b-729af7abf578"
}