<p>Setzt den Status des Vertrages anhand des Datumfeldes "Terminated" in Duration auf den angegebenen Wert.<br /><br /></p><div>-- =============================================</div><div>-- Author:<span class="Apple-tab-span" style="white-space:pre">		</span>Stefan BÃ¤tz, topfact AG</div><div>-- Create date: 27.01.2016</div><div>-- Description:<span class="Apple-tab-span" style="white-space:pre">	</span>-</div><div>-- =============================================</div><div>CREATE PROCEDURE [dbo].[Sync_TT_SetContractStatus]</div><div>AS</div><div>BEGIN</div><p><br /></p><div><span class="Apple-tab-span" style="white-space:pre">	</span>SET NOCOUNT ON;</div><p><br /></p><div><span class="Apple-tab-span" style="white-space:pre">	</span>DECLARE @id int;</div><p><br /></p><div><span class="Apple-tab-span" style="white-space:pre">	</span>DECLARE mycur CURSOR FOR&nbsp;</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>SELECT</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>VorgangID</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>FROM</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>tblContract</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>WHERE</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>(Terminated IS NOT NULL) AND (Terminated &lt; GETDATE());</div><p><br /></p><div><span class="Apple-tab-span" style="white-space:pre">	</span>OPEN mycur</div><p><br /></p><div><span class="Apple-tab-span" style="white-space:pre">	</span>FETCH NEXT FROM mycur&nbsp;</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>INTO @id</div><p><br /></p><div><span class="Apple-tab-span" style="white-space:pre">	</span>WHILE @@FETCH_STATUS = 0</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>BEGIN</div><p><br /></p><div><span class="Apple-tab-span" style="white-space:pre">		</span>UPDATE</div><div><span class="Apple-tab-span" style="white-space:pre">			</span>tblAktivitaet</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>SET</div><div><span class="Apple-tab-span" style="white-space:pre">			</span>fk_tblStatus = 63</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>WHERE</div><div><span class="Apple-tab-span" style="white-space:pre">			</span>ID = @id</div><p><br /></p><div><span class="Apple-tab-span" style="white-space:pre">		</span>FETCH NEXT FROM mycur&nbsp;</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>INTO @id</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>END&nbsp;</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>CLOSE mycur;</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>DEALLOCATE mycur;</div><p><br /></p><div>END</div><p><br /></p><div>GO</div><p><br /></p><p><br /></p>