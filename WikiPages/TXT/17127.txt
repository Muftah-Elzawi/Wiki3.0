<p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green"><span style="color: #000000;"><span style="font-family: Verdana;">Mit dem nachfolgendem Skript können die in topfact6 angelegten Benutzer in die topteam Datenbank importiert werden.<br />Das Skript aktualisiert auch abgeänderte Einträge.<br />Damit ein Benutzer in der topteam-Tabelle aktualisiert wird, muss jedoch ein DateModified Datum in der topfact6 Benutzertabelle sein, das größer oder gleich dem DateModified in der tblAnsprechpartner ist. Dabei wird nicht nur auf das Datum geschaut, selbst die Uhrzeit wird dabei mit eingebezogen.<br /></span></span><br /><br />-- Skript zum aktualisieren der topteam Benutzer</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- topteam Benutzer werden für den Aufgabenversand benötigt</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- !!ACHTUNG!!</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">--</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- WIRD BEI EINEM topfact6 Benutzer DER BENUTZERNAME ODER VORNAME GEÄNDERT,</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- DANN WIRD DER BENUTZER GELÖSCHT UND NEU ANGELGT. </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- DER BENUTZER WIRD DANN NICHT GEUPDATET!!!</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- DAS VERÄNDERT DIE GUID DES USERS IN DEM topteam-SYSTEM.</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">--</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- !!ACHTUNG!!&nbsp; </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- Variablen für das Eintragen/Updaten/Löschen</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">DECLARE</span> </p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @ttID <span style="color:blue">INT</span><span style="color:gray">,</span> @Firma <span style="color:blue">INT</span><span style="color:gray">,</span> @Vorname <span style="color:blue">VARCHAR</span><span style="color:gray">(</span>100<span style="color:gray">),</span> @Nachname <span style="color:blue">VARCHAR</span><span style="color:gray">(</span>100<span style="color:gray">),</span> </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @Username <span style="color:blue">VARCHAR</span><span style="color:gray">(</span>100<span style="color:gray">),</span> @Email <span style="color:blue">VARCHAR</span><span style="color:gray">(</span>100<span style="color:gray">),</span> @PwdHash <span style="color:blue">VARCHAR</span><span style="color:gray">(</span><span style="color:fuchsia">MAX</span><span style="color:gray">),</span> </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @inaktiv <span style="color:blue">INT</span><span style="color:gray">,</span>&nbsp; @IsTopserv <span style="color:blue">BIT</span><span style="color:gray">,</span> @IsTopservAdmin <span style="color:blue">BIT</span><span style="color:gray">,</span> @DMSUser <span style="color:blue">VARCHAR</span><span style="color:gray">(</span>100<span style="color:gray">),</span> </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @DMSPwd <span style="color:blue">VARCHAR</span><span style="color:gray">(</span><span style="color:fuchsia">MAX</span><span style="color:gray">),</span> @Guid <span style="color:blue">VARCHAR</span><span style="color:gray">(</span>50<span style="color:gray">),</span> @DateCreated <span style="color:blue">DATETIME</span><span style="color:gray">,</span> @UserCreated <span style="color:blue">VARCHAR</span><span style="color:gray">(</span>50<span style="color:gray">),</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @DateModified <span style="color:blue">DATETIME</span><span style="color:gray">,</span> @UserModified <span style="color:blue">VARCHAR</span><span style="color:gray">(</span>50<span style="color:gray">),</span> @tf6DateModified <span style="color:blue">DATETIME</span><span style="color:gray">,</span> @ttDateModified <span style="color:blue">DATETIME</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">DECLARE</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> c <span style="color:blue">CURSOR</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">FOR</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">SELECT</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tt<span style="color:gray">.</span>ID<span style="color:gray">,</span>&nbsp; </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tf6<span style="color:gray">.</span>Vorname<span style="color:gray">,</span> </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tf6<span style="color:gray">.</span>Nachname<span style="color:gray">,</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tf6<span style="color:gray">.</span>Benutzername<span style="color:gray">,</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tf6<span style="color:gray">.</span>EMail<span style="color:gray">,</span> </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tf6<span style="color:gray">.</span>Passwort<span style="color:gray">,</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:9.5pt;font-family:  Consolas,Consolas;color:gray">(</span><span style="font-size:9.5pt;font-family: Consolas,Consolas; color:blue">CASE</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> tf6<span style="color:gray">.</span>Aktiv </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">WHEN</span> 0 <span style="color:blue">THEN</span> 1 </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">WHEN</span> 1 <span style="color:blue">THEN</span> 0 </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">END</span><span style="color:gray">)</span> <span style="color:blue">AS</span> inaktiv<span style="color:gray">,</span> </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tf6<span style="color:gray">.</span>IsAdministrator<span style="color:gray">,</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tf6<span style="color:gray">.</span>ArchivBenutzername<span style="color:gray">,</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tf6<span style="color:gray">.</span>ArchivPasswort<span style="color:gray">,</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tf6<span style="color:gray">.</span>DateModified<span style="color:gray">,</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tt<span style="color:gray">.</span>DateModified</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">FROM</span> topfact6<span style="color:gray">.</span>dbo<span style="color:gray">.</span>TF_Benutzer tf6</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:gray">LEFT</span> <span style="color:gray">JOIN</span> topteam<span style="color:gray">.</span>dbo<span style="color:gray">.</span>tblAnsprechpartner tt</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">ON</span> tf6<span style="color:gray">.</span>Benutzername <span style="color:gray">=</span> tt<span style="color:gray">.</span>Username <span style="color:gray">AND</span> tf6<span style="color:gray">.</span>Vorname <span style="color:gray">=</span> tt<span style="color:gray">.</span>Vorname</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- Erstellungsinformationsvariablen definieren</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">SELECT</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> @DateCreated <span style="color:gray">=</span> <span style="color:fuchsia">GETDATE</span><span style="color:gray">(),</span> @UserCreated <span style="color:gray">=</span> <span style="color:red">&#39;admin&#39;</span><span style="color:gray">,</span> @DateModified <span style="color:gray">=</span> <span style="color:fuchsia">GETDATE</span><span style="color:gray">(),</span> @UserModified <span style="color:gray">=</span> <span style="color:red">&#39;admin&#39;</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- Einstellungen initialisieren</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">SELECT</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> @Firma <span style="color:gray">=</span> 1<span style="color:gray">,</span> @IsTopserv <span style="color:gray">=</span> 1</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- Aktualiseren von vorhanden Usern bei Änderungen in topfact6</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- Eintragen von neuangelegten Usern in topfact6</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">OPEN</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> c</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">FETCH</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> <span style="color:blue">NEXT</span> <span style="color:blue">FROM</span> c <span style="color:blue">INTO</span> @ttID<span style="color:gray">,</span> @Vorname<span style="color:gray">,</span> @Nachname<span style="color:gray">,</span> @Username<span style="color:gray">,</span> @Email<span style="color:gray">,</span> @PwdHash<span style="color:gray">,</span>&nbsp; @inaktiv<span style="color:gray">,</span> @IsTopservAdmin<span style="color:gray">,</span> @DMSUser<span style="color:gray">,</span> @DMSPwd<span style="color:gray">,</span> @tf6DateModified<span style="color:gray">,</span> @ttDateModified</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">WHILE</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> <span style="color:fuchsia">@@FETCH_STATUS</span> <span style="color:gray">=</span> 0</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">BEGIN</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:green">-- Eintragen eines neuangelegten topfact6 Users</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">IF</span> @ttID <span style="color:gray">IS</span> <span style="color:gray">NULL</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">BEGIN</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">SELECT</span> @Guid <span style="color:gray">=</span> <span style="color:fuchsia">CONVERT</span><span style="color:gray">(</span><span style="color:blue">VARCHAR</span><span style="color:gray">(</span>50<span style="color:gray">),</span> <span style="color:fuchsia">NEWID</span><span style="color:gray">())</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:green">--PRINT @Username + &#39; NEUER Benutzer - GUID: &#39; + @Guid + &#39; &lt;-- wird eingefügt&#39;</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">INSERT</span> <span style="color:blue">INTO</span> topteam<span style="color:gray">.</span>dbo<span style="color:gray">.</span>tblAnsprechpartner<span style="color:gray">(</span>fk_tblFirma<span style="color:gray">,</span> Nachname<span style="color:gray">,</span> Vorname<span style="color:gray">,</span> </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Username<span style="color:gray">,</span> geschDWMail<span style="color:gray">,</span> PasswortHash<span style="color:gray">,</span> inaktiv<span style="color:gray">,</span> IsTopserv<span style="color:gray">,</span> IsTopservAdmin<span style="color:gray">,</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DMSUsername<span style="color:gray">,</span> DMSPassword<span style="color:gray">,</span> UserGuid<span style="color:gray">,</span> DateCreated<span style="color:gray">,</span> UserCreated<span style="color:gray">)</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">VALUES</span><span style="color:gray">(</span>@Firma<span style="color:gray">,</span> @Nachname<span style="color:gray">,</span> @Vorname<span style="color:gray">,</span> @Username<span style="color:gray">,</span> @Email<span style="color:gray">,</span> @PwdHash<span style="color:gray">,</span> @inaktiv<span style="color:gray">,</span> </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @IsTopserv<span style="color:gray">,</span> @IsTopservAdmin<span style="color:gray">,</span> @DMSUser<span style="color:gray">,</span> @DMSPwd<span style="color:gray">,</span> @Guid<span style="color:gray">,</span> @DateCreated<span style="color:gray">,</span> @UserCreated<span style="color:gray">)</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">END</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:green">-- Updaten eines geänderten topfact6 Users</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">IF</span> @ttID <span style="color:gray">IS</span> <span style="color:gray">NOT</span> <span style="color:gray">NULL</span> <span style="color:gray">AND</span> (<span style="color:gray">(</span>@tf6DateModified <span style="color:gray">&gt;=</span> @ttDateModified<span style="color:gray">)</span> <span style="color:gray">OR</span> <span style="color:gray">((</span>@tf6DateModified <span style="color:gray">IS</span> <span style="color:gray">NOT</span> <span style="color:gray">NULL)</span> <span style="color:gray">AND</span> <span style="color:gray">(</span>@ttDateModified <span style="color:gray">IS</span> <span style="color:gray">NULL)))</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">BEGIN</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:green">--PRINT @Username + &#39; VORHANDENER Benutzer &lt;-- wird geupdatet&#39;</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:fuchsia">UPDATE</span> </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; topteam<span style="color:gray">.</span>dbo<span style="color:gray">.</span>tblAnsprechpartner</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">SET</span>&nbsp;&nbsp;&nbsp; </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fk_tblFirma <span style="color:gray">=</span> @Firma<span style="color:gray">,</span> Nachname <span style="color:gray">=</span> @Nachname<span style="color:gray">,</span> geschDWMail <span style="color:gray">=</span> @Email<span style="color:gray">,</span> PasswortHash <span style="color:gray">=</span> @PwdHash<span style="color:gray">,</span> </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inaktiv <span style="color:gray">=</span> @inaktiv<span style="color:gray">,</span> IsTopservAdmin <span style="color:gray">=</span> @IsTopservAdmin<span style="color:gray">,</span> DMSUsername <span style="color:gray">=</span> @DMSUser<span style="color:gray">,</span> </span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DMSPassword <span style="color:gray">=</span> @DMSPwd<span style="color:gray">,</span> DateModified <span style="color:gray">=</span> @DateModified<span style="color:gray">,</span> UserModified <span style="color:gray">=</span> @UserModified</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">WHERE</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ID <span style="color:gray">=</span> @ttID</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">END</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">FETCH</span> <span style="color:blue">NEXT</span> <span style="color:blue">FROM</span> c <span style="color:blue">INTO</span> @ttID<span style="color:gray">,</span> @Vorname<span style="color:gray">,</span> @Nachname<span style="color:gray">,</span> @Username<span style="color:gray">,</span> @Email<span style="color:gray">,</span> @PwdHash<span style="color:gray">,</span>&nbsp; @inaktiv<span style="color:gray">,</span> @IsTopservAdmin<span style="color:gray">,</span> @DMSUser<span style="color:gray">,</span> @DMSPwd<span style="color:gray">,</span> @tf6DateModified<span style="color:gray">,</span> @ttDateModified</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">END</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">CLOSE</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> c</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">DEALLOCATE</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> c</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:green">-- Entfernen der gelöschten topfact6 Benutzer</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">DECLARE</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> c <span style="color:blue">CURSOR</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">FOR</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">SELECT</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tt<span style="color:gray">.</span>ID</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">FROM</span> topteam<span style="color:gray">.</span>dbo<span style="color:gray">.</span>tblAnsprechpartner tt</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:gray">LEFT</span> <span style="color:gray">JOIN</span> topfact6<span style="color:gray">.</span>dbo<span style="color:gray">.</span>TF_Benutzer tf6</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">ON</span> tf6<span style="color:gray">.</span>Benutzername <span style="color:gray">=</span> tt<span style="color:gray">.</span>Username <span style="color:gray">AND</span> tf6<span style="color:gray">.</span>Vorname <span style="color:gray">=</span> tt<span style="color:gray">.</span>Vorname</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">WHERE</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tf6<span style="color:gray">.</span>UserId <span style="color:gray">IS</span> <span style="color:gray">NULL</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">OPEN</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> c</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">FETCH</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> <span style="color:blue">NEXT</span> <span style="color:blue">FROM</span> c <span style="color:blue">INTO</span> @ttID</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">WHILE</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> <span style="color:fuchsia">@@FETCH_STATUS</span> <span style="color:gray">=</span> 0</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">BEGIN</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:green">--PRINT CONVERT(VARCHAR(100),@ttID) + &#39; &lt;-- zu löschen&#39;</span></span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">DELETE</span> <span style="color:blue">FROM</span> topteam<span style="color:gray">.</span>dbo<span style="color:gray">.</span>tblAnsprechpartner</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">WHERE</span> ID <span style="color:gray">=</span> @ttID</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue">FETCH</span> <span style="color:blue">NEXT</span> <span style="color:blue">FROM</span> c <span style="color:blue">INTO</span> @ttID</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;">&nbsp;</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">END</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">CLOSE</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> c</span></p>  <p style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;text-autospace:none"><span style="font-size: 9.5pt;font-family: Consolas,Consolas;color:blue">DEALLOCATE</span><span style="font-size:9.5pt;font-family: Consolas,Consolas;"> c</span></p>  <p>&nbsp;</p>  <p style="text-align: left;">&nbsp;<span style="font-size: 8pt;"><em><span style="font-family: Verdana;">Daniel Paulus, 29.08.2019</span></em></span></p>