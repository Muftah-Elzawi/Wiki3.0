<p>Dieser Artikel beschreibt wie fehlerhafte MSSQL Datenbanken geprüft und automatisch repariert werden können.</p><p>Achtung, das anwenden&nbsp;der Befehle erfolgt &quot;auf&nbsp;eigenes Risiko&quot;.</p><p>Sichern Sie falls möglich die Datenbank.</p><p><br /></p><p style="text-align: left; margin: 0pt;"><span style="color: #008000; font-family: Consolas; font-size: 9.5pt;">-- 1. Den Status der betroffenen Datenbank zurücksetzen</span></p><p style="font-family: Consolas; font-size: 9.5pt; text-align: left; margin: 0pt;"><span style="color: #0000ff;">EXEC</span><span> </span><span style="color: #800000;">sp_resetstatus</span><span style="color: #0000ff;"> </span><span style="color: #ff0000;">&#39;topfact6&#39;</span><span style="color: #808080;">;</span></p><p style="font-family: Consolas; font-size: 9.5pt; text-align: left; margin: 0pt;"><span style="color: #0000ff;">ALTER</span><span> </span><span style="color: #0000ff;">DATABASE</span><span> topfact6 </span><span style="color: #0000ff;">SET</span><span> </span><span style="color: #0000ff;">EMERGENCY</span><span style="color: #808080;">;</span></p><p style="text-align: left; margin: 0pt;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;</span></p><p style="text-align: left; margin: 0pt;"><span style="color: #008000; font-family: Consolas; font-size: 9.5pt;">-- 2. Datenbank auf beschädigte Objekte überprüfen</span></p><p style="font-family: Consolas; font-size: 9.5pt; text-align: left; margin: 0pt;"><span style="color: #0000ff;">DBCC</span><span> checkdb</span><span style="color: #808080;">(</span><span style="color: #ff0000;">&#39;topfact6&#39;</span><span style="color: #808080;">);</span></p><p style="text-align: left; margin: 0pt;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;</span></p><p style="text-align: left; margin: 0pt;"><span style="color: #008000; font-family: Consolas; font-size: 9.5pt;">-- 3. Datenbank in Single User mode setzen</span></p><p style="font-family: Consolas; font-size: 9.5pt; text-align: left; margin: 0pt;"><span style="color: #0000ff;">ALTER</span><span> </span><span style="color: #0000ff;">DATABASE</span><span> topfact6 </span><span style="color: #0000ff;">SET</span><span> </span><span style="color: #0000ff;">SINGLE_USER</span><span> </span><span style="color: #0000ff;">WITH</span><span> </span><span style="color: #0000ff;">ROLLBACK</span><span> </span><span style="color: #0000ff;">IMMEDIATE</span><span style="color: #808080;">;</span></p><p style="text-align: left; margin: 0pt;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;</span></p><p style="text-align: left; margin: 0pt;"><span style="color: #008000; font-family: Consolas; font-size: 9.5pt;">-- 4. Reparaturversuch ohne Datenverlust</span></p><p style="font-family: Consolas; font-size: 9.5pt; text-align: left; margin: 0pt;"><span style="color: #0000ff;">DBCC</span><span> CheckDB</span><span style="color: #0000ff;"> </span><span style="color: #808080;">(</span><span style="color: #ff0000;">&#39;topfact6&#39;</span><span style="color: #808080;">,</span><span> REPAIR</span><span style="color: #808080;">);</span></p><p style="font-family: Consolas; font-size: 9.5pt; text-align: left; margin: 0pt;"><span style="color: #0000ff;">DBCC</span><span> CheckDB</span><span style="color: #0000ff;"> </span><span style="color: #808080;">(</span><span style="color: #ff0000;">&#39;topfact6&#39;</span><span style="color: #808080;">,</span><span> REPAIR_REBUILD</span><span style="color: #808080;">);</span></p><p style="text-align: left; margin: 0pt;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;</span></p><p style="text-align: left; margin: 0pt;"><span style="color: #008000; font-family: Consolas; font-size: 9.5pt;">-- 5. Reparaturversuch mit Datenverlust der beschädigten Objekte</span></p><p style="font-family: Consolas; font-size: 9.5pt; text-align: left; margin: 0pt;"><span style="color: #0000ff;">DBCC</span><span> CheckDB</span><span style="color: #0000ff;"> </span><span style="color: #808080;">(</span><span style="color: #ff0000;">&#39;topfact6&#39;</span><span style="color: #808080;">,</span><span> REPAIR_ALLOW_DATA_LOSS</span><span style="color: #808080;">);</span></p><p style="text-align: left; margin: 0pt;"><span style="font-family: Consolas; font-size: 9.5pt;">&nbsp;</span></p><p style="text-align: left; margin: 0pt;"><span style="color: #008000; font-family: Consolas; font-size: 9.5pt;">-- 6. Datenbank wieder online schalten</span></p><p style="font-family: Consolas; font-size: 9.5pt; text-align: left; margin: 0pt;"><span style="color: #0000ff;">ALTER</span><span> </span><span style="color: #0000ff;">DATABASE</span><span> topfact6 </span><span style="color: #0000ff;">SET</span><span> </span><span style="color: #0000ff;">MULTI_USER</span><span style="color: #808080;">;</span></p>